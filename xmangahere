#!/usr/bin/sh

query="$*"
[ "$query" ] || query=$(rofi -dmenu -lines 0)

if [ -z "$query" ]; then
    echo "Nothing to search here..."
    exit 1
fi

echo "Searching for $query..."

title=$(./search.py "$query" | rofi -dmenu)

if [ -z "$title" ]; then
    echo "Nothing to search here..."
    exit 1
fi

echo "Loading volumes for $title..."

volume=$(./loadvolumes.py $title | rofi -dmenu)

echo "Loading page links for $volume..."

pages=$(./loadpages.py "$volume")

echo "Page links are loaded. Oppening a viewer..."

feh -. $pages
